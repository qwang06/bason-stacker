(()=>{"use strict";var e={95:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;class s extends Phaser.Physics.Arcade.Image{constructor(e,t,s,i){super(e,t,s,"coin"),this.setScale(.15),e.physics.add.existing(this),e.add.existing(this),i?this.setCollideWorldBounds(!0,0,0,!0):this.setCollideWorldBounds(!1),this.setOrigin(0),this.setGravityY(0)}}t.Coin=s,t.default=s},567:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=new Phaser.Events.EventEmitter;t.default=s},552:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),s(24);const a=i(s(62)),n=i(s(422)),o=i(s(724)),r=i(s(105)),d=i(s(924)),c=i(s(241)),h=i(s(982)),l=i(s(656)),u=i(s(346)),f={width:375,height:667,type:Phaser.AUTO,parent:"content",title:"Bason Stacker",physics:{default:"arcade",arcade:{gravity:{x:0,y:300}}},render:{pixelArt:!1},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}};class m extends Phaser.Game{constructor(e){d.default.LogSceneMethodEntry("Game","constructor"),super(e),this.scene.add(a.default.Name,a.default),this.scene.add(n.default.Name,n.default),this.scene.add(r.default.Name,r.default),this.scene.add(o.default.Name,o.default),this.scene.add(c.default.Name,c.default),this.scene.add(h.default.Name,h.default),this.scene.add(l.default.Name,l.default),this.scene.add(u.default.Name,u.default),this.scene.start(a.default.Name)}}t.default=m,window.onload=()=>{new m(f)}},62:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(422)),n=i(s(924));class o extends Phaser.Scene{preload(){}create(){n.default.LogSceneMethodEntry("Boot","create"),this.scene.start(a.default.Name)}}t.default=o,o.Name="Boot"},346:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(241));class n extends Phaser.Scene{create({score:e}){this.score=e,this.setupUI()}setupUI(){this.overlay=this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0,.5).setOrigin(0,0),this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"Game Over",{fontSize:"40px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5),this.add.text(this.cameras.main.centerX,this.cameras.main.centerY-50,`Score: ${this.score}`,{fontSize:"20px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5);const e=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY+50,"Restart",{fontSize:"40px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5).setInteractive({useHandCursor:!0});e.on("pointerdown",(()=>{console.log("Restarting game"),this.scene.start(a.default.Name),this.scene.stop(n.Name)})),e.on("pointerover",(()=>{e.setColor("#00ffff")})),e.on("pointerout",(()=>{e.setColor("#ffffff")}))}}t.default=n,n.Name="GameOver"},241:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),n=i(s(656)),o=i(s(346)),r=i(s(95)),d=i(s(567));class c extends Phaser.Scene{init(){this.movingCoins=[],this.stackedCoins=[],this.bottomCoins=[],this.coinsToSpawn=3,this.timesStacked=0}create(){a.default.LogSceneMethodEntry("MainGame","create"),this.scene.launch(n.default.Name),this.setupBackground(),this.setupCoins(),this.setupClickEvents()}update(){let e;if(this.stackedCoins.forEach((t=>{if(0===t.body.velocity.y){t.y=Math.round(t.y);const e=Math.round((this.cameras.main.height-t.y)/t.displayHeight);t.y=Math.round(this.cameras.main.height-e*t.displayHeight)}(!e||t.y<e.y)&&(e=t)})),this.movingCoins.length){const t=this.movingCoins[0];this.movingCoins.forEach(((s,i)=>{s.x=t.x+(s.displayWidth+0)*i,e&&(s.setVelocityY(0),console.log(e.y,s.y),s.y=Math.round(e.y-s.displayHeight),console.log(e.y,s.y))}))}}checkBoundaries(e,t,s,i,a){(i||a)&&this.movingCoins.forEach((e=>{e.setVelocityX(300*(i?1:-1))}))}setupBackground(){const e=this.cameras.main.width,t=this.cameras.main.height;this.physics.world.bounds.width=e,this.physics.world.bounds.height=t;const s=this.add.image(0,0,"BG").setOrigin(0);s.setScale(Math.max(e/s.width,t/s.height)),s.x=0-(s.displayWidth-e)/2,s.setScrollFactor(0,1);const i=this.add.image(0,0,"cult_underground2").setOrigin(0);i.setScale(Math.max(e/i.width,t/i.height)),i.x=0-(i.displayWidth-e)/2,i.setScrollFactor(0,1);const a=this.add.image(0,0,"bason_cave_lw3").setOrigin(0);a.setScale(Math.max(e/a.width,t/a.height)),a.x=0-(a.displayWidth-e)/2,a.y=this.cameras.main.height,a.setScrollFactor(0,1);const n=this.add.image(0,0,"FINAL_CAMPSCENE").setOrigin(0);n.setScale(Math.max(e/n.width,t/n.height)),n.x=0-(n.displayWidth-e)/2,n.y=this.cameras.main.height,n.setScrollFactor(0,1),this.backgrounds=[i,a,n],this.currentBgIndex=0}setupClickEvents(){this.input.on("pointerdown",this.coinsStack.bind(this)),this.physics.world.on("worldbounds",this.checkBoundaries.bind(this))}setupCoins(){this.spawnNewCoins()}coinsStack(){const e=this.movingCoins[0],t=e.x%e.displayWidth,s=t<e.displayWidth/2,i=e.body.velocity.x>0?"right":"left";let a=0;if(this.movingCoins.forEach((e=>{e.setVelocity(0,0),e.x=e.x-(s?t:t-e.displayWidth),e.y=Math.round(e.y),this.stackedCoins.find((t=>(console.log({y:e.y,stackedY:t.y,diff:Math.abs(e.y+e.displayWidth-t.y)}),e.x===t.x&&Math.abs(e.y+e.displayWidth-t.y)<10)))&&a++})),e.x+e.displayWidth*this.movingCoins.length>this.cameras.main.width){const e=this.movingCoins[this.movingCoins.length-1];e.x=this.cameras.main.width-e.displayWidth/2,e.setCollideWorldBounds(!1)}this.stackedCoins.length?(this.coinsToSpawn=a,a>0&&this.timesStacked++):this.timesStacked++,this.physics.add.collider(this.movingCoins,this.stackedCoins,((e,t)=>{e.setVelocityY(0),t.setVelocityY(0)})),this.stackedCoins.push(...this.movingCoins),this.movingCoins=[],this.spawnNewCoins(e.x,i),d.default.emit("coinStacked",this.timesStacked),this.timesStacked>3&&this.simulateScrolling()}spawnNewCoins(e=0,t="right"){if(0===this.coinsToSpawn)return console.log("game over"),this.scene.launch(o.default.Name,{score:this.timesStacked}),void this.scene.pause();let s;if(this.stackedCoins.length){const e=this.stackedCoins[this.stackedCoins.length-1];s=e.y-e.displayHeight}for(let t=0;t<this.coinsToSpawn;t++){const i=new r.default(this,0,0,!0);i.x=t*(i.displayWidth+0)+e,i.y=s||this.cameras.main.height-i.displayHeight,this.movingCoins.push(i)}this.movingCoins.forEach((e=>{e.setVelocityX(300*("right"===t?1:-1))}))}simulateScrolling(){if(this.bottomCoins=this.stackedCoins.filter((e=>Math.round(e.y+e.displayHeight)===this.cameras.main.height)),!this.bottomCoins.length)return;this.bottomCoins.forEach((e=>{e.setCollideWorldBounds(!1)}));const e=this.backgrounds[this.currentBgIndex],t=this.bottomCoins[0].displayHeight;this.add.tween({targets:e,y:e.y+t,duration:300,ease:"Linear",onComplete:()=>{this.bottomCoins.forEach((e=>{this.stackedCoins=this.stackedCoins.filter((t=>t!==e)),e.destroy()}))}}),e.y>=this.cameras.main.height&&(this.currentBgIndex++,this.backgrounds[this.currentBgIndex].y=0)}}t.default=c,c.Name="MainGame"},724:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),n=i(s(241)),o=i(s(982));class r extends Phaser.Scene{preload(){}create(){a.default.LogSceneMethodEntry("MainMenu","create");const e=this.cameras.main.height/3,t=this.add.text(this.cameras.main.centerX,e,"Start");t.setFontFamily("monospace").setFontSize(40).setFill("#fff").setAlign("center").setOrigin(.5),t.setInteractive(),t.on("pointerdown",(()=>{this.scene.start(n.default.Name)}),this);const s=this.add.text(this.cameras.main.centerX,2*e,"Settings");s.setOrigin(.5),s.setFontFamily("monospace").setFontSize(30).setFill("#fff"),s.setInteractive(),s.on("pointerdown",(()=>{this.scene.start(o.default.Name)}),this)}update(){}}t.default=r,r.Name="MainMenu"},982:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),n=i(s(724));class o extends Phaser.Scene{create(){a.default.LogSceneMethodEntry("MainSettings","create");const e=this.cameras.main.height/4,t=this.add.text(this.cameras.main.centerX,2*e,"Go Back");t.setOrigin(.5).setFontFamily("monospace").setFontSize(25).setFill("#fff").setInteractive(),t.on("pointerdown",(()=>{this.scene.start(n.default.Name)}),this)}}t.default=o,o.Name="MainSettings"},422:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(241)),n=i(s(924));class o extends Phaser.Scene{preload(){this.addProgressBar(),this.load.path="assets/",this.load.bitmapFont("arcade","fonts/arcade.png","fonts/arcade.xml"),this.load.image("cult_underground2"),this.load.image("BG"),this.load.image("bason_cave_lw3"),this.load.image("FINAL_CAMPSCENE"),this.load.image("coin","front_coin_flat.png")}create(){n.default.LogSceneMethodEntry("Preloader","create"),this.scene.start(a.default.Name)}update(){}addProgressBar(){const e=this.cameras.main.width,t=this.cameras.main.height,s="#ffffff",i=this.add.graphics(),a=this.add.graphics();a.fillStyle(2236962,.8),a.fillRect(e/4,t/2-30,e/2,50);const n=this.make.text({x:e/2,y:t/2-50,text:"Loading...",style:{fontFamily:"VT323, monospace",fontSize:"20px",color:s}});n.setOrigin(.5,.5);const o=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{fontFamily:"VT323, monospace",fontSize:"18px",color:"#ffffff"}});o.setOrigin(.5,.5);const r=this.make.text({x:e/2,y:t/2+50,text:"",style:{fontFamily:"VT323, monospace",fontSize:"18px",color:s}});r.setOrigin(.5,.5),this.load.on("progress",(s=>{o.setText(parseInt(100*s+"",10)+"%"),i.clear(),i.fillStyle(16777215,1),i.fillRect(e/4+10,t/2-30+10,(e/2-10-10)*s,30)})),this.load.on("fileprogress",(e=>{r.setText("Loading asset: "+e.key)})),this.load.on("complete",(()=>{i.destroy(),a.destroy(),n.destroy(),o.destroy(),r.destroy()}))}}t.default=o,o.Name="Preloader"},105:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(924)),n=i(s(724));class o extends Phaser.Scene{preload(){this.load.path="assets/"}create(){a.default.LogSceneMethodEntry("SplashScreen","create"),this.add.text(this.cameras.main.centerX,.5*this.cameras.main.centerY,"Starter Project for Phaser 3 with TypeScript").setOrigin(.5,0).setFontFamily("monospace").setFontSize(26).setFill("#fff");const e=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY-25,"Powered By");e.setOrigin(.5,.5),e.setFontFamily("monospace").setFontSize(20).setFill("#fff"),this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"phaser_pixel_medium_flat"),this.input.setDefaultCursor("pointer"),this.input.on("pointerdown",this.loadMainMenu,this),this.time.addEvent({delay:3e3,callback:this.loadMainMenu,callbackScope:this,loop:!1})}loadMainMenu(){this.scene.start(n.default.Name)}}t.default=o,o.Name="SplashScreen"},656:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(567)),n=i(s(924));class o extends Phaser.Scene{create(){n.default.LogSceneMethodEntry("UI","create"),this.setupUI(),this.setupisteners(),this.scene.pause()}setupUI(){this.panel=this.add.rectangle(10,10,125,40,16777215,.5).setOrigin(0,0).setStrokeStyle(2,0),this.scoreText=this.add.text(20,20,"Score: 0",{fontSize:"20px",color:"#000000",fontFamily:"VT323, monospace"})}setupisteners(){a.default.on("coinStacked",this.updateScore,this)}updateScore(e){this.scoreText.setText(`Score: ${e}`)}}t.default=o,o.Name="UI"},924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static Log(e){console.log((new Date).toISOString()+" : "+e)}static LogSceneMethodEntry(e,t){this.Log("Entered "+e+" "+t+"()")}}},24:e=>{e.exports=Phaser}},t={};!function s(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}(552)})();
//# sourceMappingURL=app.js.map