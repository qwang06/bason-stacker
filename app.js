(()=>{"use strict";var t={95:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Coin=void 0;class s extends Phaser.Physics.Arcade.Image{constructor(t,e,s,i){super(t,e,s,"coin"),this.setScale(.15),t.physics.add.existing(this),t.add.existing(this),i?this.setCollideWorldBounds(!0,0,0,!0):this.setCollideWorldBounds(!1),this.setOrigin(0),this.setGravityY(0)}}e.Coin=s,e.default=s},567:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=new Phaser.Events.EventEmitter;e.default=s},552:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),s(24);const a=i(s(62)),n=i(s(422)),o=i(s(724)),r=i(s(105)),d=i(s(924)),c=i(s(241)),h=i(s(982)),l=i(s(656)),u=i(s(346)),f={width:375,height:600,type:Phaser.AUTO,parent:"content",title:"Bason Stacker",physics:{default:"arcade",arcade:{gravity:{x:0,y:300}}},render:{pixelArt:!1}};class m extends Phaser.Game{constructor(t){d.default.LogSceneMethodEntry("Game","constructor"),super(t),this.scene.add(a.default.Name,a.default),this.scene.add(n.default.Name,n.default),this.scene.add(r.default.Name,r.default),this.scene.add(o.default.Name,o.default),this.scene.add(c.default.Name,c.default),this.scene.add(h.default.Name,h.default),this.scene.add(l.default.Name,l.default),this.scene.add(u.default.Name,u.default),this.scene.start(a.default.Name)}}e.default=m,window.onload=()=>{new m(f)}},62:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(422)),n=i(s(924));class o extends Phaser.Scene{preload(){}create(){n.default.LogSceneMethodEntry("Boot","create"),this.scene.start(a.default.Name)}}e.default=o,o.Name="Boot"},346:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(241));class n extends Phaser.Scene{create({score:t}){this.score=t,this.setupUI()}setupUI(){this.overlay=this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0,.5).setOrigin(0,0),this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"Game Over",{fontSize:"40px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5),this.add.text(this.cameras.main.centerX,this.cameras.main.centerY-50,`Score: ${this.score}`,{fontSize:"20px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5);const t=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY+50,"Restart",{fontSize:"40px",color:"#ffffff",fontFamily:"VT323, monospace"}).setOrigin(.5).setInteractive({useHandCursor:!0});t.on("pointerdown",(()=>{console.log("Restarting game"),this.scene.start(a.default.Name),this.scene.stop(n.Name)})),t.on("pointerover",(()=>{t.setColor("#00ffff")})),t.on("pointerout",(()=>{t.setColor("#ffffff")}))}}e.default=n,n.Name="GameOver"},241:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(924)),n=i(s(656)),o=i(s(346)),r=i(s(95)),d=i(s(567));class c extends Phaser.Scene{init(){this.movingCoins=[],this.stackedCoins=[],this.bottomCoins=[],this.coinsToSpawn=3,this.timesStacked=0}create(){a.default.LogSceneMethodEntry("MainGame","create"),this.scene.launch(n.default.Name),this.setupBackground(),this.setupCoins(),this.setupClickEvents()}update(){let t;if(this.stackedCoins.forEach((e=>{if(0===e.body.velocity.y){e.y=Math.round(e.y);const t=Math.round((this.cameras.main.height-e.y)/e.displayHeight);e.y=Math.round(this.cameras.main.height-t*e.displayHeight)}(!t||e.y<t.y)&&(t=e)})),this.movingCoins.length){const e=this.movingCoins[0];this.movingCoins.forEach(((s,i)=>{s.x=e.x+(s.displayWidth+0)*i,t&&(s.setVelocityY(0),console.log(t.y,s.y),s.y=Math.round(t.y-s.displayHeight),console.log(t.y,s.y))}))}}checkBoundaries(t,e,s,i,a){(i||a)&&this.movingCoins.forEach((t=>{t.setVelocityX(300*(i?1:-1))}))}setupBackground(){const t=this.cameras.main.width,e=this.cameras.main.height;this.physics.world.bounds.width=t,this.physics.world.bounds.height=e;const s=this.add.image(0,0,"BG").setOrigin(0);s.setScale(Math.max(t/s.width,e/s.height)),s.x=0-(s.displayWidth-t)/2,s.setScrollFactor(0,1);const i=this.add.image(0,0,"cult_underground2").setOrigin(0);i.setScale(Math.max(t/i.width,e/i.height)),i.x=0-(i.displayWidth-t)/2,i.setScrollFactor(0,1);const a=this.add.image(0,0,"bason_cave_lw3").setOrigin(0);a.setScale(Math.max(t/a.width,e/a.height)),a.x=0-(a.displayWidth-t)/2,a.y=this.cameras.main.height,a.setScrollFactor(0,1);const n=this.add.image(0,0,"FINAL_CAMPSCENE").setOrigin(0);n.setScale(Math.max(t/n.width,e/n.height)),n.x=0-(n.displayWidth-t)/2,n.y=this.cameras.main.height,n.setScrollFactor(0,1),this.backgrounds=[i,a,n],this.currentBgIndex=0}setupClickEvents(){this.input.on("pointerdown",this.coinsStack.bind(this)),this.physics.world.on("worldbounds",this.checkBoundaries.bind(this))}setupCoins(){this.spawnNewCoins()}coinsStack(){const t=this.movingCoins[0],e=t.x%t.displayWidth,s=e<t.displayWidth/2,i=t.body.velocity.x>0?"right":"left";let a=0;if(this.movingCoins.forEach((t=>{t.setVelocity(0,0),t.x=t.x-(s?e:e-t.displayWidth),t.y=Math.round(t.y),this.stackedCoins.find((e=>(console.log({y:t.y,stackedY:e.y,diff:Math.abs(t.y+t.displayWidth-e.y)}),t.x===e.x&&Math.abs(t.y+t.displayWidth-e.y)<10)))&&a++})),t.x+t.displayWidth*this.movingCoins.length>this.cameras.main.width){const t=this.movingCoins[this.movingCoins.length-1];t.x=this.cameras.main.width-t.displayWidth/2,t.setCollideWorldBounds(!1)}this.stackedCoins.length?(this.coinsToSpawn=a,a>0&&this.timesStacked++):this.timesStacked++,this.physics.add.collider(this.movingCoins,this.stackedCoins,((t,e)=>{t.setVelocityY(0),e.setVelocityY(0)})),this.stackedCoins.push(...this.movingCoins),this.movingCoins=[],this.spawnNewCoins(t.x,i),d.default.emit("coinStacked",this.timesStacked),this.timesStacked>3&&this.simulateScrolling()}spawnNewCoins(t=0,e="right"){if(0===this.coinsToSpawn)return console.log("game over"),this.scene.launch(o.default.Name,{score:this.timesStacked}),void this.scene.pause();let s;if(this.stackedCoins.length){const t=this.stackedCoins[this.stackedCoins.length-1];s=t.y-t.displayHeight}for(let e=0;e<this.coinsToSpawn;e++){const i=new r.default(this,0,0,!0);i.x=e*(i.displayWidth+0)+t,i.y=s||this.cameras.main.height-i.displayHeight,this.movingCoins.push(i)}this.movingCoins.forEach((t=>{t.setVelocityX(300*("right"===e?1:-1))}))}simulateScrolling(){if(this.bottomCoins=this.stackedCoins.filter((t=>Math.round(t.y+t.displayHeight)===this.cameras.main.height)),!this.bottomCoins.length)return;this.bottomCoins.forEach((t=>{t.setCollideWorldBounds(!1)}));const t=this.backgrounds[this.currentBgIndex],e=this.bottomCoins[0].displayHeight;this.add.tween({targets:t,y:t.y+e,duration:300,ease:"Linear",onComplete:()=>{this.bottomCoins.forEach((t=>{this.stackedCoins=this.stackedCoins.filter((e=>e!==t)),t.destroy()}))}}),t.y>=this.cameras.main.height&&(this.currentBgIndex++,this.backgrounds[this.currentBgIndex].y=0)}}e.default=c,c.Name="MainGame"},724:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(924)),n=i(s(241)),o=i(s(982));class r extends Phaser.Scene{preload(){}create(){a.default.LogSceneMethodEntry("MainMenu","create");const t=this.cameras.main.height/3,e=this.add.text(this.cameras.main.centerX,t,"Start");e.setFontFamily("monospace").setFontSize(40).setFill("#fff").setAlign("center").setOrigin(.5),e.setInteractive(),e.on("pointerdown",(()=>{this.scene.start(n.default.Name)}),this);const s=this.add.text(this.cameras.main.centerX,2*t,"Settings");s.setOrigin(.5),s.setFontFamily("monospace").setFontSize(30).setFill("#fff"),s.setInteractive(),s.on("pointerdown",(()=>{this.scene.start(o.default.Name)}),this)}update(){}}e.default=r,r.Name="MainMenu"},982:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(924)),n=i(s(724));class o extends Phaser.Scene{create(){a.default.LogSceneMethodEntry("MainSettings","create");const t=this.cameras.main.height/4,e=this.add.text(this.cameras.main.centerX,2*t,"Go Back");e.setOrigin(.5).setFontFamily("monospace").setFontSize(25).setFill("#fff").setInteractive(),e.on("pointerdown",(()=>{this.scene.start(n.default.Name)}),this)}}e.default=o,o.Name="MainSettings"},422:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(241)),n=i(s(924));class o extends Phaser.Scene{preload(){this.addProgressBar(),this.load.path="assets/",this.load.bitmapFont("arcade","fonts/arcade.png","fonts/arcade.xml"),this.load.image("cult_underground2"),this.load.image("BG"),this.load.image("bason_cave_lw3"),this.load.image("FINAL_CAMPSCENE"),this.load.image("coin","front_coin_flat.png")}create(){n.default.LogSceneMethodEntry("Preloader","create"),this.scene.start(a.default.Name)}update(){}addProgressBar(){const t=this.cameras.main.width,e=this.cameras.main.height,s="#ffffff",i=this.add.graphics(),a=this.add.graphics();a.fillStyle(2236962,.8),a.fillRect(t/4,e/2-30,t/2,50);const n=this.make.text({x:t/2,y:e/2-50,text:"Loading...",style:{fontFamily:"VT323, monospace",fontSize:"20px",color:s}});n.setOrigin(.5,.5);const o=this.make.text({x:t/2,y:e/2-5,text:"0%",style:{fontFamily:"VT323, monospace",fontSize:"18px",color:"#ffffff"}});o.setOrigin(.5,.5);const r=this.make.text({x:t/2,y:e/2+50,text:"",style:{fontFamily:"VT323, monospace",fontSize:"18px",color:s}});r.setOrigin(.5,.5),this.load.on("progress",(s=>{o.setText(parseInt(100*s+"",10)+"%"),i.clear(),i.fillStyle(16777215,1),i.fillRect(t/4+10,e/2-30+10,(t/2-10-10)*s,30)})),this.load.on("fileprogress",(t=>{r.setText("Loading asset: "+t.key)})),this.load.on("complete",(()=>{i.destroy(),a.destroy(),n.destroy(),o.destroy(),r.destroy()}))}}e.default=o,o.Name="Preloader"},105:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(924)),n=i(s(724));class o extends Phaser.Scene{preload(){this.load.path="assets/"}create(){a.default.LogSceneMethodEntry("SplashScreen","create"),this.add.text(this.cameras.main.centerX,.5*this.cameras.main.centerY,"Starter Project for Phaser 3 with TypeScript").setOrigin(.5,0).setFontFamily("monospace").setFontSize(26).setFill("#fff");const t=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY-25,"Powered By");t.setOrigin(.5,.5),t.setFontFamily("monospace").setFontSize(20).setFill("#fff"),this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"phaser_pixel_medium_flat"),this.input.setDefaultCursor("pointer"),this.input.on("pointerdown",this.loadMainMenu,this),this.time.addEvent({delay:3e3,callback:this.loadMainMenu,callbackScope:this,loop:!1})}loadMainMenu(){this.scene.start(n.default.Name)}}e.default=o,o.Name="SplashScreen"},656:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(s(567)),n=i(s(924));class o extends Phaser.Scene{create(){n.default.LogSceneMethodEntry("UI","create"),this.setupUI(),this.setupisteners(),this.scene.pause()}setupUI(){this.panel=this.add.rectangle(10,10,125,40,16777215,.5).setOrigin(0,0).setStrokeStyle(2,0),this.scoreText=this.add.text(20,20,"Score: 0",{fontSize:"20px",color:"#000000",fontFamily:"VT323, monospace"})}setupisteners(){a.default.on("coinStacked",this.updateScore,this)}updateScore(t){this.scoreText.setText(`Score: ${t}`)}}e.default=o,o.Name="UI"},924:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static Log(t){console.log((new Date).toISOString()+" : "+t)}static LogSceneMethodEntry(t,e){this.Log("Entered "+t+" "+e+"()")}}},24:t=>{t.exports=Phaser}},e={};!function s(i){var a=e[i];if(void 0!==a)return a.exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,s),n.exports}(552)})();
//# sourceMappingURL=app.js.map